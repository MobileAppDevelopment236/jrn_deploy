<!DOCTYPE html>
<html>
<head>
    <title>Authentication Callback</title>
    <script>
        function processAuthCallback() {
            try {
                const url = new URL(window.location.href);
                const hashParams = new URLSearchParams(url.hash.substring(1));
                
                const token = hashParams.get('access_token');
                const type = hashParams.get('type');
                const error = hashParams.get('error');
                
                console.log('Auth callback processing:', { type, hasToken: !!token, error });
                
                // Handle password recovery
                if (token && type === 'recovery') {
                    localStorage.setItem('password_reset_required', 'true');
                    localStorage.setItem('supabase_recovery_token', token);
                    localStorage.setItem('supabase_recovery_type', 'recovery');
                    localStorage.setItem('reset_timestamp', new Date().toISOString());
                }
                
                // Handle errors
                if (error) {
                    localStorage.setItem('auth_error_type', error);
                    localStorage.setItem('auth_error_timestamp', new Date().toISOString());
                }
                
            } catch (error) {
                console.log('Auth callback completed');
            }
            
            // Always redirect to main app
            setTimeout(() => {
                window.location.href = 'https://www.jrrgo.com/';
            }, 500);
        }
        
        document.addEventListener('DOMContentLoaded', processAuthCallback);
    </script>
</head>
<body>
    <p>Processing authentication... Redirecting to app.</p>
</body>
</html>