<!DOCTYPE html>
<html>
<head>
    <title>Password Reset - JRR Immigration</title>
    <script>
        function handleResetRedirect() {
            console.log('üîÑ Reset password page loaded');
            
            // Extract token from URL
            const urlParams = new URLSearchParams(window.location.search);
            const hashParams = new URLSearchParams(window.location.hash.substring(1));
            
            const token = urlParams.get('access_token') || hashParams.get('access_token');
            const type = urlParams.get('type') || hashParams.get('type');
            
            console.log('üîê Token extracted:', !!token);
            console.log('üîê Type:', type);
            
            if (token && type === 'recovery') {
                // Store token in localStorage
                localStorage.setItem('password_reset_required', 'true');
                localStorage.setItem('supabase_recovery_token', token);
                localStorage.setItem('supabase_recovery_type', 'recovery');
                localStorage.setItem('reset_timestamp', new Date().toISOString());
                
                console.log('‚úÖ Tokens stored, redirecting to main app...');
            }
            
            // Always redirect to main Flutter app
            window.location.href = 'https://www.jrrgo.com/';
        }
        
        document.addEventListener('DOMContentLoaded', handleResetRedirect);
    </script>
</head>
<body>
    <div style="display: flex; justify-content: center; align-items: center; height: 100vh; font-family: Arial, sans-serif;">
        <div style="text-align: center;">
            <h2>Password Reset</h2>
            <p>Redirecting to JRR Immigration App...</p>
        </div>
    </div>
</body>
</html>